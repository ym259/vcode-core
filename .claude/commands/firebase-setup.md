# /firebase-setup - Firebase プロジェクトセットアップ

Firebase プロジェクトの作成と設定をブラウザ操作でアシストします。

## 重要な原則

- **ユーザーは非エンジニア。** 技術的な説明は最小限に、「次はここをクリックしてください」レベルで案内する。
- Chrome MCP を使ってブラウザを操作し、Firebase Console の画面を直接開いてナビゲートする。
- ユーザーがログインや課金設定など**アカウント操作が必要な部分だけ**ユーザーに操作してもらう。
- それ以外のクリック操作（サービスの有効化、設定値のコピーなど）はエージェントが行う。

## 手順

### ステップ 1: Firebase Console を開く

Chrome MCP でブラウザタブを作成し、Firebase Console を開く：
- URL: `https://console.firebase.google.com/`
- ユーザーに伝える：「Firebase Console を開きました。Googleアカウントでログインしてください。ログインが完了したら教えてください。」
- **ユーザーのログイン完了を待つ。** ログインはユーザー自身が行う（エージェントは認証操作をしない）。

### ステップ 2: プロジェクト作成

ユーザーがログインしたら：
1. 「プロジェクトを作成」ボタンをクリック
2. プロジェクト名を入力（`PROJECT.md` のプロジェクト名を使う）
3. Google Analytics はオフに設定
4. 作成完了を待つ

ユーザーに伝える：「Firebase プロジェクトを作成しています。少し時間がかかります。」

### ステップ 3: ウェブアプリの追加と設定値の取得

プロジェクト作成直後に設定値を取得する（後のステップで必要）：

1. Firebase Console → プロジェクトの設定（歯車アイコン）→ 「全般」
2. 「マイアプリ」セクションの「ウェブ」アイコン（`</>`）をクリック
3. アプリのニックネームを入力（プロジェクト名）
4. Firebase Hosting はチェックしない
5. 「アプリを登録」をクリック
6. 表示される `firebaseConfig` の値を読み取る
7. `.env.local` ファイルを作成して設定値を書き込む：

```
NEXT_PUBLIC_FIREBASE_API_KEY=...
NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN=...
NEXT_PUBLIC_FIREBASE_PROJECT_ID=...
NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET=...
NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID=...
NEXT_PUBLIC_FIREBASE_APP_ID=...
```

ユーザーに伝える：「Firebase の設定値を取得して、プロジェクトに保存しました。」

### ステップ 4: Authentication の有効化

1. Firebase Console のサイドバーから「Authentication」に移動
2. 「始める」をクリック
3. 「Sign-in method」タブで必要なプロバイダーを有効化：
   - **メール/パスワード**: 「メール/パスワード」をクリック → 有効にする → 保存
   - **Google**: 「Google」をクリック → 有効にする → プロジェクトのサポートメール（ユーザーのメール）を選択 → 保存
4. `PROJECT.md` の技術設計に記載された認証方法に合わせて設定する

ユーザーに伝える：「ログイン機能の設定を行っています。」

### ステップ 5: Firestore Database の作成

1. Firebase Console のサイドバーから「Firestore Database」に移動
2. 「データベースを作成」をクリック
3. ロケーション: `asia-northeast1`（東京）を選択
4. セキュリティルール: 「テストモードで開始」を選択
5. 作成完了を待つ

ユーザーに伝える：「データベースを作成しています。」

### ステップ 6: Storage の有効化（必要な場合のみ）

**`PROJECT.md` の技術設計で Firebase Storage を使う場合のみ実行する。使わない場合はスキップ。**

Storage には Blaze プラン（従量課金）が必要：

1. Firebase Console の左下「Spark」プラン表示をクリック、または課金ページに移動
2. ユーザーに伝える：
   「画像のアップロード機能を使うために、Firebase の Blaze プラン（従量課金）に切り替える必要があります。無料枠が大きいので、個人開発レベルでは基本的に無料で使えます。課金情報の入力をお願いします。完了したら教えてください。」
3. **ユーザーの課金設定完了を待つ。** 課金情報の入力はユーザー自身が行う。
4. Blaze プランになったら、サイドバーから「Storage」に移動
5. 「始める」をクリック
6. セキュリティルール: デフォルトのまま「次へ」
7. ロケーション: Firestore と同じ `asia-northeast1`
8. 完了を待つ

### ステップ 7: 完了

「Firebase のセットアップが完了しました！🎉 データベースとログイン機能が使えるようになりました。」

## ブラウザ操作がうまくいかない場合

Firebase Console のUIが変わっていたり、ボタンが見つからない場合：
1. スクリーンショットを撮って状況を確認する
2. ユーザーに「画面に〇〇と書かれたボタンが見えますか？クリックしてください」と案内する
3. 2〜3回試してうまくいかなければ、URLを直接提示してユーザーに手動操作してもらう
