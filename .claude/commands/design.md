# /design - デザインリサーチ & フィードバック

コーディングを始める前に、既存アプリのデザインをリサーチし、ユーザーと一緒にデザインの方向性を決めます。

## 前提

- ユーザーが何を作りたいか（例：LMS、ECサイト）は既に分かっている状態で実行する
- `/start` フローの一部として自動的に呼ばれるか、単独で `/design` として実行される
- ブラウザ操作用の Chrome MCP が利用可能であることを前提とする

## 手順

### ステップ 1: リファレンスアプリの特定

作りたいアプリの種類に基づいて、既存の有名なサービスを 3〜5 個リストアップする。

例（LMSの場合）：
- Coursera (coursera.org)
- Canvas LMS (canvas.instructure.com)
- Google Classroom (classroom.google.com)
- Udemy (udemy.com)
- Notion（レイアウト参考）

ユーザーに確認する：
「以下のサービスをデザインの参考として調べます。他に参考にしたいサイトはありますか？」

### ステップ 2: リファレンスサイトをブラウザで表示

Chrome MCP を使って各リファレンスサイトを実際にブラウザで開く：

1. `tabs_context_mcp` でタブグループを取得（なければ作成）
2. 各リファレンスサイトごとに新しいタブを作成
3. 各タブでサイトに `navigate` する
4. 各サイトで `screenshot` を撮影する
5. スクリーンショットを分析し、以下のデザイン要素を日本語で説明する：
   - **レイアウト**: サイドバーの有無、ヘッダーの構成、コンテンツエリアの配置
   - **カラー**: メインカラー、背景色、アクセントカラー
   - **ナビゲーション**: メニュー構造、パンくずリスト、タブの使い方
   - **カード/コンテンツの見せ方**: グリッド、リスト、テーブル

各サイトの分析後、簡潔にまとめてユーザーに伝える：
「[サービス名] は [レイアウトの特徴] で、[カラーの特徴] を使っています。[特に参考になるポイント]。」

### ステップ 3: デザイン方向性のヒアリング

すべてのリファレンスを見せた後、ユーザーにデザインの好みを聞く。
以下の項目について順番に確認する：

#### 3a. レイアウト
「レイアウトはどのタイプが好みですか？」
- サイドバー + ヘッダー（Notion/Canvas型）
- トップナビ + コンテンツ（Coursera型）
- ミニマル（Google Classroom型）

#### 3b. カラー
「色の雰囲気はどんな感じがいいですか？」
- 現在のデフォルト: インディゴブルー（信頼感・教育系）
- ユーザーの具体的な好み（「もっとダークに」「緑系がいい」「パステル調で」など）
- 参考サイトから「○○の色合いが好き」という指定

#### 3c. 雰囲気
「全体の雰囲気はどんな感じにしたいですか？」
- プロフェッショナル / ビジネス系
- カジュアル / フレンドリー
- ミニマル / クリーン
- ポップ / カラフル

### ステップ 4: デザインシステムの更新

ユーザーのフィードバックをもとに、以下のファイルを更新する：

#### 4a. `src/app/globals.css` のCSS変数を更新
- `--primary` と `--primary-foreground`: ユーザーが選んだメインカラー
- `--ring` と `--sidebar-primary`: primaryに合わせて更新
- `--sidebar-ring`: primaryに合わせて更新
- ダークモード側の `--primary` も合わせて調整
- カラー値はすべて oklch() 形式を維持する

oklch 参考値（よく使うカラー）：
```
/* Blue系 */
oklch(0.488 0.18 264)   /* indigo-blue (default) */
oklch(0.546 0.245 262)  /* vivid blue */
oklch(0.623 0.214 259)  /* sky blue */

/* Green系 */
oklch(0.527 0.15 155)   /* emerald */
oklch(0.448 0.119 151)  /* dark green */

/* Purple系 */
oklch(0.496 0.215 292)  /* violet */
oklch(0.558 0.288 302)  /* vivid purple */

/* Red/Orange系 */
oklch(0.577 0.245 27)   /* red (destructive default) */
oklch(0.705 0.213 47)   /* orange */

/* Warm系 */
oklch(0.554 0.135 66)   /* amber */

/* Neutral系 */
oklch(0.37 0.013 285)   /* dark zinc */
oklch(0.21 0.006 286)   /* near black */
```

#### 4b. `.claude/rules/design-system.md` を更新
ユーザーが選んだレイアウトパターンやカラーの方針を反映する。
例：
- 「サイドバー + ヘッダー」を選んだ → レイアウトセクションに明記
- 「ダーク系」を選んだ → 「ダークモードをデフォルトにする」を追記
- カラーの制約を追記（「ピンクは使わない」など）

#### 4c. `PROJECT.md` にデザイン方針を追記
```markdown
## デザイン方針
- レイアウト: [選択されたレイアウト]
- メインカラー: [カラー名と用途]
- 雰囲気: [選択された雰囲気]
- 参考サイト: [リファレンスURL一覧]
- その他: [ユーザーからの具体的な要望]
```

### ステップ 5: プレビュー & 確認

更新したデザインシステムを使って、シンプルなプレビューページを作成する：
- 選択されたレイアウト（サイドバー or トップナビ）
- メインカラーが適用されたボタン、カード、ヘッダー
- 日本語テキストでのサンプルコンテンツ

`npm run dev` でサーバーを起動し、ブラウザで確認を促す：
「デザインのプレビューを作りました。ブラウザで確認してください。修正したい点があれば教えてください。」

修正があればデザインシステムを再度更新し、プレビューに反映する。
ユーザーがOKを出すまでこのループを繰り返す。

### ステップ 6: 完了

デザインが決定したら：
「デザインの方向性が決まりました！この設定で開発を進めていきます 🎨」

`/start` から呼ばれた場合は、次のステップ（機能の実装）に自動的に進む。

---

## Chrome MCP が使えない場合のフォールバック

Chrome MCP が利用できない場合は、以下の代替フローを使う：

1. WebSearch でリファレンスアプリを検索し、特徴をテキストで説明する
2. ユーザーに「実際のサイトをブラウザで開いて確認してみてください」と案内する
3. ユーザーからの口頭フィードバック（「Courseraのような青い感じ」）をもとにデザインシステムを更新する
4. プレビューページを作成し、`npm run dev` で確認してもらう

## 単独実行時の注意

`/start` を経由せずに `/design` を単独で実行された場合：
1. まず「何を作っていますか？」と聞く
2. `PROJECT.md` が存在すればそこから情報を読み取る
3. 存在しなければ、アプリの種類を確認してからステップ 1 に進む
